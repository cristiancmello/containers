version: 2.1

jobs:
  build-deploy:
    machine: true
    steps:
        - checkout
        - run: |
            echo "$DOCKERHUB_PASSWORD" | docker login --username $DOCKERHUB_LOGIN --password-stdin
        - run: |
            docker build -t cristiancmello/ubuntu:{CIRCLE_BRANCH} ./{CIRCLE_BRANCH}
        - run: |
            docker push cristiancmello/ubuntu:{CIRCLE_BRANCH}

workflows:
  version: 2
  build-deploy-dockerimage:
    jobs:
      - build-deploy:
          context: docker-hub
          filters:
            branches:
              only:
                - ubuntu-20.04/base